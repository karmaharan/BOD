<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Before Interview V1 </title>
<meta name="description" content="an AI based Resume Analysis Tool--Made in India">
<meta name="keywords" content="AI resume, Ai Resume Analysis, Resume Analysis, AI resume analysis, AI resume analysis tool, AI resume analysis platform, AI resume analysis website, AI resume analysis app, AI resume analysis software">
<link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
<link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
<script src="{{ url_for('static', filename='js/flow.js') }}"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <nav>
        <div class="nav-container">
            <div class="nav-logo">
                <img src="https://i.ibb.co/MC4BzT3/logo.png" alt="Logo" class="navbar-logo" />
                <div class="nav-title">
                    BeforeInterview
                </div>
            </div>
            <button class="nav-toggle">Menu</button>
            <ul class="nav-menu">
                <li><a href="#home">Home</a></li>
                <li><a href="#mission">Mission Control</a></li>
                <li><a href="#done">Launch Analysis</a></li>
                <li><a href="#Resultz">Report</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            {% if user %}
            <div class="nav-actions">
                <div class="user-greeting">
                    Hello, {{ user.name }}!
                </div>
                <a href="/logout">
                    <button class="action-button">
                        Logout
                    </button>
                </a>
            </div>
            {% else %}
            <a href="/login">
                <button class="button">
                    Login
                </button>
            </a>
            
            {% endif %}
        </div>
        <div id="queue-status" style="display: none;">
            <strong>Queue Status:</strong>
            <p id="queue-position"></p>
        </div>
    </nav>
    
    
    <div class="parallax" style="background-image: url('https://i.ibb.co/86BzXS0/6861232.jpg');">

                <div class="content">
            <h1>BIAI (before interview artificial intelligence)</h1>
            <p>not getting selected for an interview? want to BOOST your CV?</p>
            <p>Tune your resume "BEFORE INTERVIEW"</p>

        </div>
    </div>

    <div class="section"id="home">
        <div class="content">
            <h2>Tune your CV to get your desired and deserving job.</h2>
            <p>Take control of your career trajectory! Upload your resume, set your job targets, and let our advanced AI navigate you through the job market with precision.</p>
        </div>
    </div>

    <div class="parallax" id="done" style="background-image: url('https://i.ibb.co/3hmC7Vg/5143312.jpg');">
        <div class="spinner-div" id="spinner-div">
            <div class="loading-container">
                <div class="ai-eye">
                    <div class="ai-pupil"></div>
                </div>
                <div class="resume" id="resume"></div>
                <div class="status-text" id="statusText">AI analyzing resume...</div>
            </div>
        </div>
    
        <div class="content" id="formpoint">
            <h2>Launch Your Career Analysis</h2>
            {% if not user %}
            <div class="login-overlay">
                <div class="login-message">
                    <h2>Login Required</h2>
                    <p>You need to log in to use this feature.</p>
                    <a href="/login">
                        <button class="login-button">Log In</button>
                    </a>
                </div>
            </div>
            {% endif %}
            <form id="resumeForm" method="POST" enctype="multipart/form-data">
                <label for="file" class="upload-button">Upload Your Resume</label>
                <input type="file" id="file" name="file" accept=".pdf, .jpg, .jpeg, .png" required><br><br>
            
                <label for="job_title">Set Your Job Target:</label><br>
                <input type="text" id="job_title" name="job_title" required><br><br>
            
                <input type="submit" value="Launch Analysis">
            </form>
            
            
        </div>
    </div>
    
    <div class="section" style="
    min-height: 0vh!important;
">
        <h2>The Personalized Report</h2>
        <p>Get a detailed analysis of your strengths, weaknesses, and job opportunities. Unlock new career paths and take the first step towards success!</p>
    </div>
    
    <div class="parallax" style="background-image: url('https://i.ibb.co/DfB4dc4/hr-process-4783430-1280.png');">
        <div class="content" id="Resultz" style="display: none;max-width: 100vw!important;">
            <div id="results"></div>
            <button class="no-print" onclick="printResults()">Print</button>
        </div>
    </div>
    
    <div class="section">
        <h2>BIAI - Flow Diagram</h2>
        <p>How our technology works</p>
    </div>
    
    <div class="parallax" style="background-image: url('https://i.ibb.co/HK0mL2k/8401.jpg');">
        <div class="mindmap-container">
            <h1 class="title">BIAI - Flow Diagram</h1>
            <div id="mindmap"></div>
        </div>
        <div class="tooltip"></div>
    </div>
    

    <div class="section" id="about">
        <div class="content">
            <h2>About BIAI</h2>
            <p>BIAI is your AI-powered career companion designed to give your resume the boost it needs before any interview. By analyzing market trends and tailoring your resume to specific job roles, BIAI helps you stand out in the competitive job market.</p>
        </div>
    </div>

    <div class="section" id="contact">
        <div class="content">
            <h2>Contact Us</h2>
            <p>If you have any questions or need support, feel free to reach out to us at <a href="mailto:admin@techtantra.tech" style="color: #ffffff; text-decoration: underline;">admin@techtantra.tech</a>.</p>
            <li>
                THIS APP IS ON SALE for 10,000$ 
                Contact Us 
                <a href="mailto:we@techtantra.tech?subject=Inquiry%20About%20App%20Sale&body=Hello%2C%0D%0AI%20am%20interested%20in%20purchasing%20the%20app%20that%20is%20on%20sale%20for%2010%2C000%24.%20Please%20provide%20me%20with%20more%20details.%0D%0AThank%20you." style="color: white;">
                  we@techtantra.tech
                </a>
              </li>
              
        </div>
    </div>
    <style>
        @media print {
            body * {
                visibility: hidden;
            }
            #results, #results * {
                visibility: visible;
            }
            #results {
                position: absolute;
                left: 0;
                top: 0;
            }
            .no-print {
            display: none;
        }
        }
    </style>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script>

    </script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.11.1/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.11.1/dist/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.11.1/dist/ScrollToPlugin.min.js"></script>
    <script>
            // Function to scroll to the Resultz section
    function scrollToResults() {
        document.getElementById('Resultz').scrollIntoView({ behavior: 'smooth' });
    }

    // Simulate results being ready (you would call this when your results are available)
    function onResultsReady() {
        // Hide spinner, show results, etc.
        document.getElementById('spinner-div').style.display = 'none';
        document.getElementById('results').innerHTML = '<p>Results are here!</p>'; // Replace with actual results
        scrollToResults(); // Scroll to the results section
    }
        function printResults() {
    window.print();
}
function printResults() {
    const resultsContent = document.getElementById('results').innerHTML;
    const printWindow = window.open('', '', 'height=600,width=800');
    
    // Add styles for print
    printWindow.document.write('<html><head><title>Print Analysis</title>');
    printWindow.document.write('<style>');
    printWindow.document.write('@media print {');
    printWindow.document.write('  body { font-family: Arial, sans-serif; }');
    printWindow.document.write('  .no-print { display: none; }');
    printWindow.document.write('  .page-break { page-break-after: always; }');
    printWindow.document.write('  .container { margin: 20px; }');
    printWindow.document.write('  .header { text-align: center; font-size: 24px; font-weight: bold; }');
    printWindow.document.write('  .footer { text-align: center; font-size: 12px; margin-top: 20px; }');
    printWindow.document.write('}');
    printWindow.document.write('</style>');
    printWindow.document.write('</head><body>');
    printWindow.document.write('<div class="container">');
    printWindow.document.write('<div class="header">Analysis Report</div>');
    printWindow.document.write(resultsContent);
    printWindow.document.write('<div class="footer">Generated on: ' + new Date().toLocaleDateString() + '</div>');
    printWindow.document.write('</div>');
    printWindow.document.write('</body></html>');
    
    printWindow.document.close();
    printWindow.print();
}



        document.addEventListener('DOMContentLoaded', function () {
    const navToggle = document.querySelector('.nav-toggle');
    const navMenu = document.querySelector('.nav-menu');

    navToggle.addEventListener('click', function () {
        navMenu.classList.toggle('active');
    });
});

    gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

    // Parallax effect
    gsap.utils.toArray(".parallax").forEach((section, i) => {

        


    });

    document.getElementById('resumeForm').addEventListener('submit', async function(event) {
    event.preventDefault();  // Prevent form from submitting the default way

    {% if not user %}
        alert('You need to log in to use this feature.');
        return;
    {% endif %}

    // Show the spinner
    document.getElementById('spinner-div').style.display = 'block';

    const formData = new FormData(document.getElementById('resumeForm'));

    try {
        const response = await fetch('/analyze_resume', {
            method: 'POST',
            body: formData
        });

        // Check for unauthorized status code
        if (response.status === 401) {
            document.getElementById('results').innerText = 'Error: You need to log in to access this feature.';
            return;
        }

        // Check if the response is JSON
        const contentType = response.headers.get('Content-Type');
        if (contentType && contentType.includes('application/json')) {
            const data = await response.json();

            if (data.error) {
                document.getElementById('results').innerText = `Error: ${data.error}`;
                return;
            }

            // Check if the user is in a queue
            if (data.queue_position !== undefined) {
                document.getElementById('results').innerHTML = `
                    <strong>Queue Status:</strong> You are in position ${data.queue_position} of ${data.total_queue}. Please wait for your analysis to be processed.
                `;
                return;
            }

            // If analysis results are available, display them
            const formatList = (items) => {
                if (Array.isArray(items)) {
                    return items.map(item => `<li>${item}</li>`).join('');
                }
                return '<li>No data available</li>';
            };

            document.getElementById('results').innerHTML = `
                <strong>Full Analysis:</strong> <pre>${data.full_analysis || 'No detailed analysis available'}</pre>
                <strong>Potential Companies in India:</strong> <pre>${data.potential_companies_india || 'No data available'}</pre>
                <strong>Potential Companies Globally:</strong> <pre>${data.potential_companies_global || 'No data available'}</pre>
                <strong>India Job Market Similarity:</strong> <pre>${data.india_job_market_similarity || 'No data available'}</pre>
                <strong>Global Job Market Similarity:</strong> <pre>${data.global_job_market_similarity || 'No data available'}</pre>
                <strong>Example Similarity:</strong> <pre>${data.example_similarity || 'No data available'}</pre>
            `;

            // Scroll to results
            gsap.to(window, {duration: 1, scrollTo: "#results"});
        } else {
            throw new Error('Unexpected response type');
        }
    } catch (error) {
        document.getElementById('results').innerText = `Error: ${error.message}`;
    } finally {
        // Hide the spinner
        document.getElementById('spinner-div').style.display = 'none';

        // Show the results section
        document.getElementById('Resultz').style.display = 'block';
    }
});


// Set the logout timer
let logoutTimer;

// Function to reset the timer
function resetLogoutTimer() {
    clearTimeout(logoutTimer);
    startLogoutTimer();
}

// Function to start the logout timer
function startLogoutTimer() {
    // Set timer for 30 minutes (30 * 60 * 1000 milliseconds)
    logoutTimer = setTimeout(() => {
        triggerLogout();
    }, 30 * 60 * 1000);
}

// Function to trigger logout
function triggerLogout() {
    fetch('/logout', {
        method: 'POST', // Using GET since your route handles a GET request
        credentials: 'same-origin' // Include cookies with the request
    }).then(response => {
        if (response.redirected) {
            window.location.href = response.url; // Redirect to the home page
        } else {
            console.error('Logout failed');
        }
    }).catch(error => console.error('Error:', error));
}

// Reset the timer on user activity
window.onload = resetLogoutTimer;
document.onmousemove = resetLogoutTimer;
document.onkeydown = resetLogoutTimer;
document.onclick = resetLogoutTimer;
document.onscroll = resetLogoutTimer;

// Start the timer when the script is loaded
startLogoutTimer();

// Attempt to trigger logout when the tab or browser is closed
window.addEventListener('beforeunload', (event) => {
    // Trigger the logout request when the tab or window is about to be closed
    navigator.sendBeacon('/logout');
});

    </script>